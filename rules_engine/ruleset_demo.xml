<root ruleset_id="test1" ruleset_name="test1" type="C">
    <rule id="reverse_shell_01" name="反弹shell检测" author="test">
        <filter field="data_type">42</filter>
        <checklist condition="node1 and node2">
            <node id="a" type="INCL" field="data" logic="or" delimiter="|">
                <![CDATA[_$test1|test2]]>
            </node>
            <node id="b" type="INCL" field="data" logic="or" delimiter="|">
                <![CDATA[test1|test2]]>
            </node>
            <node id="c" type="PLUGIN">plugin_name(_$ORIDATA)</node>
        </checklist>

        <threshold group_by="ip,port" range="30s" local_cache="true" count_type="CLASSIFY" count_field="dip">5</threshold>

        <append type="STATIC" field_name="data_type">10</append>
        <append type="PLUGIN" field_name="data_type">plugin_name($_ORIDATA)</append>
        <append type="PLUGIN" field_name="data_type">plugin_name("test", 123 , _$pid)</append>
        <del>sport,dport</del>
    </rule>
</root>